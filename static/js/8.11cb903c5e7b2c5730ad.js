webpackJsonp([8],{"1kh3":function(e,t){},"4kZv":function(e,t){},"5K1E":function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"upload-dragger",class:{dragover:e.dragover},on:{drop:function(t){return t.preventDefault(),t.stopPropagation(),e.onDrop(t)},dragover:function(t){return t.preventDefault(),e.onDragover(t)},dragleave:function(t){if(t.preventDefault(),t.stopPropagation(),t.target!==t.currentTarget)return null;e.dragover=!1}}},[e._t("default")],2)},staticRenderFns:[]};t.a=s},"5vdu":function(e,t){},D0dC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"upload-drag-box",props:{disabled:Boolean},data:()=>({dragover:!1}),methods:{onDragover(){this.disabled||(this.dragover=!0)},onDrop(e){this.disabled||(this.dragover=!1,this.$emit("file",e.dataTransfer.files))}}}},L4js:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(a("exGp")),i=n(a("M4fF")),o=n(a("amSP")),r=a("7mV8"),l=a("gyMJ");function n(e){return e&&e.__esModule?e:{default:e}}t.default={name:"upload-box",components:{uploadDragBox:o.default},props:{sizeKbLimit:{type:Number,default:20480},fileList:{type:Array,required:!0},updateFiles:{type:Function}},data:()=>({action:"",payload:{},supportFormat:["doc","docx","ppt","pptx","xls","xlsx","pdf"]}),methods:{transmitFiles(e){this.$refs.uploader.$refs["upload-inner"].uploadFiles(e)},transmitRemove(e){this.$refs.uploader.handleRemove(e)},getUploadURL({md5:e,name:t}){var a=this;return(0,s.default)(function*(){let{url:s}=yield(0,l.getFileURL)({md5:e,name:t});a.action=s})()},setPageInfo(e){var t=this;return(0,s.default)(function*(){if("success"===e.status&&!i.default.has(e,"pageInfo")){let{pageCount:a,isVertical:s}=yield(0,l.getPage)({md5:e.raw.md5,name:e.name});t.$set(e,"pageInfo",{pageCount:a,isVertical:s})}})()},fileSizeLimit(e,t){if(e.size/1024>t)throw this.$notify.error({title:"请不要上传太大的文件",message:`该文件 ${e.name} 大小超过 ${t/1024}MB 限制，无法上传`}),new Error("stop-upload Size too large")},fileFormatCheck(e){let t=this.supportFormat;if(e.extension=e.name.split(".").pop().toLowerCase(),!e.name.match(/\./)||t.findIndex(t=>t===e.extension)<0)throw this.$notify.error({title:`暂不支持此文件格式: ${e.extension}`,message:`当前仅支持 ${t.join("，")} 等格式。`}),new Error("stop-upload Format not support");if(e.name.match(/^~\$/))throw this.$notify.error({title:'该文件为 "影子文件"，无法打印',message:`文件 ${e.name} 为"影子文件"，无法添加到打印列表。请添加相同目录下不以 "~$" 开头的同名文件，它才是本尊！`}),new Error("stop-upload Office Temp")},fileExistCheck(e){var t=this;return(0,s.default)(function*(){let a=yield(0,l.getPage)(e);if("EXISTED"===a.state){let{pageCount:s,isVertical:i}=a;throw e.pageInfo={pageCount:s,isVertical:i},t.$refs.uploader.handleStart(e),new Error("stop-upload File existed")}})()},onBeforeUpload(e){var t=this;return(0,s.default)(function*(){t.fileSizeLimit(e,t.sizeKbLimit),t.fileFormatCheck(e),e.md5=yield(0,r.getFileMD5)(e),e.origin="本地上传",yield t.fileExistCheck(e),yield t.getUploadURL(e)})()},onChange(e,t){var a=this;return(0,s.default)(function*(){yield a.setPageInfo(e),i.default.has(e,["raw","pageInfo"])||a.updateFiles(t)})()},onProgress(e,t){let{loaded:a,total:s,timeStamp:o}=e,r=i.default.get(t,"loaded",{loaded:a,total:s,timeStamp:o}),l=o>r.timeStamp?(a-r.loaded)/1024/((o-r.timeStamp)/1e3):0,n=(s-a)/1024/(l||1);this.$set(t,"loaded",{loaded:a,timeStamp:o}),this.$set(t,"speed",l.toFixed(2)),this.$set(t,"remain",n.toFixed(0))},onErrorUpload(e){console.error("err-upload",e),this.$notify.error({title:"上传出错",message:"请检查网络和文件类型"})},onRemoveFile(e,t){this.updateFiles(t)}}}},Mwod:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-box-out"},[a("upload-drag-box",{on:{file:e.transmitFiles}},[e._t("default"),e._v(" "),a("el-upload",{ref:"uploader",staticClass:"upload",attrs:{multiple:"",action:e.action,data:e.payload,"show-file-list":!1,"file-list":e.fileList,"on-change":e.onChange,"before-upload":e.onBeforeUpload,"on-progress":e.onProgress,"on-remove":e.onRemoveFile,"on-error":e.onErrorUpload}},[a("div",{staticClass:"upload-btn"},[e.fileList.length?a("span",{staticClass:"upload-title"},[e._v("继续添加文件")]):a("span",{staticClass:"upload-title"},[e._v("添加文件")]),e._v(" "),a("br"),e._v(" "),a("span",{staticClass:"upload-text"},[e._v("点击按钮或者把文件拖放到这里")])]),e._v(" "),a("footer",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[a("p",[e._v("已支持的格式："+e._s(e.supportFormat.join(",")))]),e._v(" "),a("p",[e._v("请勿上传包含侵权、色情、暴恐、反动等违法内容的文档")])])])],2)],1)},staticRenderFns:[]};t.a=s},SPde:function(e,t,a){"use strict";var s=a("Tp0T"),i=a.n(s),o=a("ilhS");var r=function(e){a("4kZv")},l=a("VU/8")(i.a,o.a,!1,r,"data-v-146e9a20",null);t.default=l.exports},Tp0T:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=d(a("exGp")),i=d(a("Dd8w")),o=a("NYxO"),r=a("WO9J"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a("Du/2")),n=d(a("yiCB")),u=d(a("UfA/"));function d(e){return e&&e.__esModule?e:{default:e}}t.default={name:"share-view",components:{boxCard:n.default,uploadBox:u.default},props:{},data:()=>({docsType:"ratified",fileIcon:r.icons}),computed:(0,i.default)({},(0,o.mapState)("share",["fileList"])),watch:{},mounted(){},methods:(0,i.default)({},(0,o.mapMutations)("share",{commitFiles:l.UPDATE_FILES}),{back(){this.$router.back()},changeDocsType:e=>(0,s.default)(function*(){console.log("docs type",e)})(),shareFile(e){console.log(e.raw.md5),console.log(e.share),this.deleteFile(e)},deleteFile(e){this.$refs.uploader.transmitRemove(e)}})}},"UfA/":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("WgzN");a.o(s,"default")&&a.d(t,"default",function(){return s.default})},WgzN:function(e,t,a){"use strict";var s=a("L4js"),i=a.n(s),o=a("Mwod");var r=function(e){a("5vdu")},l=a("VU/8")(i.a,o.a,!1,r,"data-v-55609a50",null);t.default=l.exports},ZiLt:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("SPde");a.o(s,"default")&&a.d(t,"default",function(){return s.default})},amSP:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("D0dC"),i=a.n(s);for(var o in s)"default"!==o&&function(e){a.d(t,e,function(){return s[e]})}(o);var r=a("5K1E");var l=function(e){a("1kh3")},n=a("VU/8")(i.a,r.a,!1,l,"data-v-f0cac12a",null);t.default=n.exports},ilhS:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"library"},[a("header",[a("div",{staticClass:"back",on:{click:e.back}},[a("i",{staticClass:"el-icon-fa-angle-left"}),a("span",[e._v("返回")])]),e._v(" "),e._m(0)]),e._v(" "),a("box-card",{staticClass:"file-list",attrs:{title:"上传并分享",noPadding:""}},[a("upload-box",{directives:[{name:"show",rawName:"v-show",value:!e.fileList.length,expression:"!fileList.length"}],ref:"uploader",attrs:{fileList:e.fileList,updateFiles:e.commitFiles}}),e._v(" "),e._l(e.fileList,function(t,s){return a("div",{key:t.name+"_"+s,staticClass:"file-item"},[a("div",{staticClass:"file-info"},[a("figure",{staticClass:"file"},[a("img",{attrs:{src:e.fileIcon[t.raw.extension],alt:"format"}}),e._v(" "),a("figcaption",{staticClass:"description"},[a("div",{staticClass:"name"},[e._v("原始名："+e._s(t.name))]),e._v(" "),a("div",{staticClass:"attribute"},[e._v("上传成功，共"+e._s(t.pageInfo&&t.pageInfo.pageCount)+"页")])])]),e._v(" "),a("div",{staticClass:"share-name"},[a("span",{staticClass:"input-tip"},[e._v("分享名称")]),e._v(" "),a("el-input",{staticClass:"input",model:{value:t.share.rename,callback:function(a){e.$set(t.share,"rename",a)},expression:"file.share.rename"}})],1),e._v(" "),a("footer",{staticClass:"footer"},[a("el-button",{staticClass:"footer-button",attrs:{type:"primary"},on:{click:function(a){e.shareFile(t)}}},[e._v("分 享")]),e._v(" "),a("el-button",{staticClass:"footer-button",on:{click:function(a){e.deleteFile(t)}}},[e._v("删 除")])],1)]),e._v(" "),a("div",{staticClass:"file-tags"},[a("span",{staticClass:"tag-tip"},[e._v("请指定文档所属的 学校科目 或 专题")]),e._v(" "),a("div",[a("span",{staticClass:"input-tip"},[e._v("学校学院")]),e._v(" "),a("el-input",{staticClass:"input",model:{value:t.share.institute,callback:function(a){e.$set(t.share,"institute",a)},expression:"file.share.institute"}})],1),e._v(" "),a("div",[a("span",{staticClass:"input-tip"},[e._v("适用年级")]),e._v(" "),a("el-input",{staticClass:"input",model:{value:t.share.semester,callback:function(a){e.$set(t.share,"semester",a)},expression:"file.share.semester"}})],1),e._v(" "),a("div",[a("span",{staticClass:"input-tip"},[e._v("专业科目")]),e._v(" "),a("el-input",{staticClass:"input",model:{value:t.share.major,callback:function(a){e.$set(t.share,"major",a)},expression:"file.share.major"}})],1),e._v(" "),a("div",[a("span",{staticClass:"input-tip"},[e._v("指定专题")]),e._v(" "),a("el-input",{staticClass:"input",model:{value:t.share.subject,callback:function(a){e.$set(t.share,"subject",a)},expression:"file.share.subject"}})],1)])])})],2),e._v(" "),a("box-card",{staticClass:"documents",attrs:{title:"分享记录"}},[a("el-menu",{staticClass:"selector-tabs",attrs:{"default-active":e.docsType,mode:"horizontal"},on:{select:e.changeDocsType}},[a("el-menu-item",{staticClass:"selector-item",attrs:{index:"ratified"}},[e._v("已审核 (0)")]),e._v(" "),a("el-menu-item",{staticClass:"selector-item",attrs:{index:"to-ratify"}},[e._v("待审核 (0)")])],1),e._v(" "),a("div",{staticClass:"empty-tip"},[e._v("暂时没有文档记录")])],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"title"},[t("i",{staticClass:"el-icon-fa-cloud-upload"}),this._v(" "),t("span",[this._v("分享中心")])])}]};t.a=s}});