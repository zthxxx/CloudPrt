webpackJsonp([6],{"/T/c":function(e,t,s){"use strict";var i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"pagebox",staticClass:"page-box",on:{scroll:e.onScroll}},[s("div",{ref:"pages",staticClass:"page-list"},e._l(e.pagepics,function(t,i){return s("figure",{key:i+t},[s("img",{class:{gray:e.isMono},attrs:{src:t},on:{load:e.onLoadimg}})])})),e._v(" "),s("footer",{ref:"footer",staticClass:"last-tip"},[e.loadEnd&&!e.loading?[e._v("已到达最后一面")]:s("div",{staticClass:"loading"},[s("spinDot",{attrs:{size:36}}),e._v(" "),s("div",{staticClass:"text"},[e._v("拼命加载中...")])],1)],2)])},staticRenderFns:[]};t.a=i},"2/yl":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("UCFC");s.o(i,"default")&&s.d(t,"default",function(){return i.default})},"5zz7":function(e,t,s){"use strict";var i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("transition",{attrs:{name:"fade"}},[this.preview&&this.file?t("preview-mask",{attrs:{price:this.price,file:this.file,update:this.updateSetting},on:{close:this.close}}):this._e()],1)},staticRenderFns:[]};t.a=i},"8szQ":function(e,t){},BXPW:function(e,t,s){"use strict";var i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("modal-backdrop",[s("article",{staticClass:"page-content"},[s("filePageBox",{attrs:{fetchPage:e.fetchPage,isMono:e.isMono,total:e.total},on:{current:e.setCurrent}})],1),e._v(" "),s("div",{staticClass:"control"},[s("print-file-item",{staticClass:"print-file-item",attrs:{price:e.price,file:e.file,preSetting:e.file.print},on:{update:e.update}},[s("div",{attrs:{slot:"control"},slot:"control"},[s("span",[s("span",{staticClass:"page-panel"},[e._v("第"),s("span",{staticClass:"count"},[e._v(e._s(e.current))]),e._v("面")]),e._v(" "),s("div",{staticClass:"tip"},[e._v("每份"+e._s(e.papers)+"张纸")]),e._v(" "),s("div",{staticClass:"tip"},[e._v(e._s(e.copies)+"份共"+e._s(e.copies*e.papers)+"张纸")])]),e._v(" "),s("aside",{staticClass:"close"},[s("i",{staticClass:"el-icon-fa-compress close-btn",on:{click:e.close}})])])])],1),e._v(" "),s("footer",{staticClass:"pagination"},[s("div",{staticClass:"panel"},[e._v(e._s(e.current)+" / "+e._s(e.total))])])])},staticRenderFns:[]};t.a=i},JYqD:function(e,t,s){"use strict";var i=s("NRGD"),a=s.n(i),l=s("5zz7"),n=s("VU/8")(a.a,l.a,!1,null,null,null);t.default=n.exports},K8Xz:function(e,t){},MOKS:function(e,t){},NRGD:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=s("tYEb"),l=(i=a)&&i.__esModule?i:{default:i};t.default={name:"file-preview",components:{previewMask:l.default},props:{price:{type:null,default:null},file:{type:null,default:null},updateSetting:{type:Function,default:()=>{}}},data:()=>({preview:!1}),methods:{open(){this.preview=!0},close(){this.preview=!1,this.$nextTick(this.$destroy)}}}},UCFC:function(e,t,s){"use strict";var i=s("jjdT"),a=s.n(i),l=s("aK0l");var n=function(e){s("K8Xz")},r=s("VU/8")(a.a,l.a,!1,n,"data-v-1ad49808",null);t.default=r.exports},aK0l:function(e,t,s){"use strict";var i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:"left-fade"}},[s("section",{staticClass:"print-file-item"},[s("div",{staticClass:"print-file",class:{"file-upload":!e.upsuccess}},[e.index?s("div",{staticClass:"valid-index"},[e._v(e._s("#"+e.index))]):e._e(),e._v(" "),e.upsuccess?e._e():s("div",{staticClass:"processor"},[s("div",{staticClass:"process-bar",style:{width:e.file.percentage+"%"}}),e._v(" "),s("div",{staticClass:"loading-info"},[s("div",{staticClass:"uploading"},[100!=e.file.percentage?[s("div",[e._v("正在上传")]),e._v(" "),s("div",{staticClass:"percentage"},[s("span",{staticClass:"loading"},[s("spinDot")],1),e._v("\n                "+e._s(e.file.percentage.toFixed(1))+"%\n              ")]),e._v(" "),s("div",{staticClass:"speed"},[e._v("剩余 "+e._s(e.file.remain||"...")+" 秒 / "+e._s(e.file.speed||0)+" kb/s")])]:[s("div",[e._v("上传完毕")]),e._v(" "),s("div",{staticClass:"analysing"},[e._v("正在分析...")])]],2)])]),e._v(" "),s("div",{staticClass:"logo-holder"},[s("div",{staticClass:"logo"},[s("img",{attrs:{src:e.fileIcon[e.file.raw.extension]}}),e._v(" "),e.upsuccess?s("div",[e._v(e._s(e.file.pageInfo.pageCount+"页"))]):s("div",[e._v(e._s(Math.ceil(e.file.size/1024))+"kb")])])]),e._v(" "),s("div",{staticClass:"file-info"},[s("div",{staticClass:"name"},[e._v(e._s(e.file.name))]),e._v(" "),s("div",{staticClass:"source"},[s("span",[e._v("来源："),s("span",[e._v(e._s(e.file.raw.origin))])])])]),e._v(" "),e.upsuccess?s("div",{staticClass:"fade-in"},[s("div",{staticClass:"delete"},[s("div",{staticClass:"control"},[e._t("control",[s("div",{staticClass:"tip"},[e._v("共需打印 "+e._s(e.total)+" 张纸")]),e._v(" "),s("div",{staticClass:"right-btn"},[s("el-button",{staticClass:"del-btn",attrs:{icon:"fa-file-text-o"},on:{click:function(t){e.handlePreview(e.file)}}},[e._v(" 打印预览\n                ")])],1),e._v(" "),s("div",{staticClass:"right-btn"},[s("el-button",{staticClass:"del-btn",attrs:{icon:"delete2"},on:{click:function(t){e.handleRemove(e.file)}}},[e._v(" 移除文件\n                ")])],1)])],2)]),e._v(" "),s("div",{staticClass:"print-choice"},[s("ul",[s("li",[s("div",[e._v("色彩")]),e._v(" "),s("div",{staticClass:"selectors"},[s("el-select",{staticClass:"colors",model:{value:e.setting.color,callback:function(t){e.$set(e.setting,"color",t)},expression:"setting.color"}},[s("el-option",{attrs:{label:"黑白",value:"mono",disabled:!("mono"in e.colorable)}}),e._v(" "),s("el-option",{attrs:{label:"彩色",value:"colorful",disabled:!("colorful"in e.colorable)}})],1)],1)]),e._v(" "),s("li",[s("div",[e._v("单双面")]),e._v(" "),s("div",{staticClass:"selectors"},[s("el-select",{staticClass:"sides",model:{value:e.setting.side,callback:function(t){e.$set(e.setting,"side",t)},expression:"setting.side"}},[s("el-option",{attrs:{label:"单面",value:1,disabled:!("oneside"in e.sideable)}}),e._v(" "),s("el-option",{attrs:{label:"双面",value:2,disabled:!("duplex"in e.sideable)}})],1)],1)]),e._v(" "),s("li",[s("div",[e._v("多合一")]),e._v(" "),s("div",{staticClass:"selectors"},[s("el-select",{staticClass:"layouts",model:{value:e.layout,callback:function(t){e.layout=t},expression:"layout"}},[s("el-option",{attrs:{label:"1合1",value:1}}),e._v(" "),s("el-option",{attrs:{label:"2合1",value:2}}),e._v(" "),e.file.pageInfo.isVertical?e._e():[s("el-option",{attrs:{label:"4合1",value:4}}),e._v(" "),s("el-option",{attrs:{label:"6合1",value:6}}),e._v(" "),s("el-option",{attrs:{label:"8合1",value:8}}),e._v(" "),s("el-option",{attrs:{label:"9合1",value:9}})]],2)],1)]),e._v(" "),s("li",[s("div",[e._v("份数")]),e._v(" "),s("div",{staticClass:"selectors"},[s("el-input-number",{staticClass:"copies",attrs:{min:1,max:1e3},model:{value:e.setting.copies,callback:function(t){e.$set(e.setting,"copies",t)},expression:"setting.copies"}})],1)])])]),e._v(" "),s("div",{staticClass:"setting"},[s("div",{staticClass:"print-area"},[s("span",{staticClass:"area-tip"},[e._v("打印范围 ")]),e._v(" "),s("span",{staticClass:"lingkage-are"},[s("el-input-number",{staticClass:"print-area-input",attrs:{controls:!1,min:1,max:e.setting.endPage},model:{value:e.setting.startPage,callback:function(t){e.$set(e.setting,"startPage",t)},expression:"setting.startPage"}}),e._v(" "),s("span",[e._v("-")]),e._v(" "),s("el-input-number",{staticClass:"print-area-input",attrs:{controls:!1,min:e.setting.startPage,max:e.file.pageInfo.pageCount},model:{value:e.setting.endPage,callback:function(t){e.$set(e.setting,"endPage",t)},expression:"setting.endPage"}})],1)]),e._v(" "),s("div",{staticClass:"print-area"},[s("span",[e._v("纸张")]),e._v(" "),s("el-select",{staticClass:"sizeside",model:{value:e.sizeside,callback:function(t){e.sizeside=t},expression:"sizeside"}},[e._l(e.price,function(e){var t=e.size,i=e.caliper;return s("el-option",{key:t+" "+i,attrs:{label:t+" "+i+" 白纸",value:JSON.stringify({size:t,caliper:i})}})}),e._v(" "),e.price?e._e():s("el-option",{attrs:{label:e.setting.size+" "+e.setting.caliper+" 白纸",value:e.sizeside}})],2)],1)])]):e._e()])])])},staticRenderFns:[]};t.a=i},gesD:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(s("Dd8w")),a=c(s("M4fF")),l=c(s("UnHi")),n=c(s("2/yl")),r=c(s("tIbB")),o=s("gyMJ");function c(e){return e&&e.__esModule?e:{default:e}}t.default={name:"preview-mask",components:{modalBackdrop:l.default,printFileItem:n.default,filePageBox:r.default},props:{price:{type:null,default:null},file:{type:null,required:!0,default:null},update:{type:Function,default:()=>{}}},data(){let e=this.file.raw.md5,{size:t,row:s,col:i}=this.file.print;return{current:1,preset:{md5:e,size:t,row:s,col:i}}},computed:{isMono(){return"mono"===this.file.print.color},total(){let{endPage:e,startPage:t,row:s,col:i}=this.file.print,a=s*i;return Math.ceil((e-t+1)/a)},papers(){let{side:e}=this.file.print;return Math.ceil(this.total/e)},copies(){return this.file.print.copies},fetchPage(){let e=this.preset;return t=>(0,o.getPreview)((0,i.default)({page:t},e))}},watch:{file:{handler({raw:{md5:e},print:{size:t,row:s,col:i}}){let l={md5:e,size:t,row:s,col:i};a.default.isEqual(l,this.preset)||(this.preset=l)},deep:!0}},mounted(){},methods:{close(){this.$emit("close")},setCurrent(e){this.current=e}}}},jFCP:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(s("exGp")),a=n(s("TCwp")),l=s("GKmE");function n(e){return e&&e.__esModule?e:{default:e}}t.default={name:"file-page-box",components:{spinDot:a.default},props:{fetchPage:{type:Function,required:!0},startPage:{type:Number,default:1},total:{type:Number,required:!0,default:0},isMono:{type:Boolean,default:!1}},data(){return{pagepics:[],currentPage:1,loading:!1,onScroll:(0,l.throttle)(this.handleScroll,300)}},computed:{loadEnd(){return this.pagepics.length>=this.total}},watch:{fetchPage:{handler(){this.pagepics=[],this.setPagePic(1)},deep:!0},total(e){this.pagepics.splice(e)}},mounted(){this.setPagePic(1)},methods:{calcCurrent(e,t,s){s=this.loading?s-1:s;let i=(e=e||1)/t*s;return Math.ceil(i)},setPagePic(e){var t=this;return(0,i.default)(function*(){if(t.loading||t.loadEnd)return;t.loading=!0;let{img:s}=yield t.fetchPage(e);t.pagepics.push(s)})()},handleScroll(){let e=this.$refs.pagebox.scrollTop,t=this.$refs.pagebox.clientHeight,s=this.$refs.pages.clientHeight,i=this.pagepics.length,a=s-t,l=this.calcCurrent(e,s,i)||1;if(this.currentPage!==l&&(this.currentPage=l,this.$emit("current",this.currentPage)),e>=a&&!this.loadEnd){let e=i+1;this.setPagePic(e)}},onLoadimg(){this.loading=!1;let e=this.$refs.pagebox.clientHeight;if(this.$refs.pagebox.scrollHeight<=e){let e=this.pagepics.length;this.setPagePic(e+1)}}}}},jjdT:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(s("woOf")),a=u(s("mvHQ")),l=u(s("Dd8w")),n=u(s("M4fF")),r=s("WO9J"),o=u(s("TCwp")),c=s("S8x/");function u(e){return e&&e.__esModule?e:{default:e}}t.default={name:"print-file-item",components:{spinDot:o.default},props:{price:{default:null},index:{type:Number,default:null},file:{type:Object,required:!0},preSetting:{type:Object,default:()=>({copies:1,size:"A4",caliper:"70g",color:"mono",side:1,row:1,col:1,startPage:1,endPage:1})},handleRemove:{type:Function},handlePreview:{type:Function}},data(){return{setting:(0,l.default)({},(0,c.checkset)(this.price,this.preSetting)),layouts:{1:{row:1,col:1},2:{row:2,col:1},4:{row:2,col:2},6:{row:3,col:2},8:{row:4,col:2},9:{row:3,col:3}},sideMap:c.sideMap,fileIcon:r.icons}},computed:{upsuccess(){let e=this.file;return"success"===n.default.get(e,"status")&&n.default.get(e,["pageInfo","pageCount"])},colorable(){let e=this.setting;if(!this.price)return{};for(let t of this.price){let{size:s,caliper:i,money:a}=t;if(e.size===s&&e.caliper===i)return a}return{}},sideable(){let e=this.setting,t=n.default.get(this.colorable,e.color,{});return n.default.has(t,n.default.invert(this.sideMap)[e.side])||(e.side=n.default.get(this.sideMap,n.default.keys(t).shift(),1)),t},sizeside:{get(){return(0,a.default)({size:this.setting.size,caliper:this.setting.caliper})},set(e){this.setting=(0,c.checkset)(this.price,(0,l.default)({},this.setting,JSON.parse(e)))}},layout:{get(){let e=this.setting;return e.row*e.col},set(e){let{row:t,col:s}=this.layouts[e];this.file.pageInfo.isVertical&&([t,s]=[s,t]),(0,i.default)(this.setting,{row:t,col:s})}},total(){let e=this.setting;return Math.ceil((e.endPage-e.startPage+1)/e.side/this.layout)*e.copies}},watch:{setting:{handler(e){for(let t of n.default.keys(this.preSetting))if(n.default.get(e,t)!==this.preSetting[t]){this.$emit("update",{uid:this.file.uid,setting:e});break}},deep:!0},price:{handler(e){e&&(this.setting=(0,c.checkset)(e,this.setting))},deep:!0},preSetting:{handler(e){this.setting=(0,l.default)({},e)},deep:!0}}}},m7Jl:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("JYqD");s.o(i,"default")&&s.d(t,"default",function(){return i.default})},tIbB:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("zUw7");s.o(i,"default")&&s.d(t,"default",function(){return i.default})},tYEb:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("gesD"),a=s.n(i);for(var l in i)"default"!==l&&function(e){s.d(t,e,function(){return i[e]})}(l);var n=s("BXPW");var r=function(e){s("MOKS")},o=s("VU/8")(a.a,n.a,!1,r,"data-v-39a973d8",null);t.default=o.exports},zUw7:function(e,t,s){"use strict";var i=s("jFCP"),a=s.n(i),l=s("/T/c");var n=function(e){s("8szQ")},r=s("VU/8")(a.a,l.a,!1,n,"data-v-bfee0056",null);t.default=r.exports}});