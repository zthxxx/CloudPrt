webpackJsonp([10],{"03le":function(t,e){},"1b4C":function(t,e,s){"use strict";var a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.visible?s("modal-backdrop",[s("div",{staticClass:"login-modal",attrs:{tabindex:"0"}},[s("div",{staticClass:"login-inner"},[s("el-button",{staticClass:"close",attrs:{icon:"close"},on:{click:t.close}}),t._v(" "),t.acceptCaptcha?s("captcha-card",{attrs:{userform:t.requestForm,back:t.backLogin},on:{signed:t.onSigned}}):s("el-form",{ref:"loginForm",staticClass:"login-content",attrs:{rules:t.rules,model:t.form}},[s("header",{staticClass:"login-header"},[s("div",{staticClass:"login-header-title"},[t._v(t._s(t.header[t.mode].title))]),t._v(" "),s("div",{staticClass:"login-header-subTitle"},[t._v(t._s(t.header[t.mode].subtitle))])]),t._v(" "),s("div",{staticClass:"login-flow"},[s("el-form-item",{staticClass:"flow-account",attrs:{prop:"username"}},[s("el-input",{staticClass:"account",attrs:{placeholder:"请输入手机号"},on:{focus:function(e){t.registerable=!0}},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}},[s("el-select",{style:{width:t.prefixWidth+"px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:t.prefix,callback:function(e){t.prefix=e},expression:"prefix"}},t._l(t.countries,function(t){var e=t.code,a=t.name;return s("el-option",{key:e,attrs:{label:""+a+e,value:JSON.stringify({code:e,name:a})}})}))],1),t._v(" "),"login"==t.mode||t.registerable?t._e():s("div",{staticClass:"endMask"},[s("span",{staticClass:"await-time"},[t._v("该手机号已注册 · ")]),t._v(" "),s("el-button",{staticClass:"switch-type",on:{click:t.loginMode}},[t._v("直接登录")])],1)],1),t._v(" "),s("el-form-item",{staticClass:"flow-password",attrs:{prop:"password"}},[s("el-input",{class:{password:t.form.password&&!t.syssee},attrs:{placeholder:"密码",type:t.syssee?"text":"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}},[s("el-button",{staticClass:"plain-button syssee",attrs:{slot:"append",icon:t.syssee?"fa-eye":"fa-eye-slash"},on:{click:function(e){t.syssee=!t.syssee}},slot:"append"})],1)],1),t._v(" "),"login"==t.mode?[s("div",{staticClass:"login-options"},[s("el-button",{staticClass:"switch-type"},[t._v("手机验证码登录")]),t._v(" "),s("el-button",{staticClass:"forget-pass"},[t._v("忘记密码？")])],1),t._v(" "),s("el-button",{staticClass:"submit",on:{click:t.login}},[t._v("登录")]),t._v(" "),s("footer",{staticClass:"login-footer"},[s("span",{staticClass:"footer-text"},[s("el-button",{staticClass:"plain-button",on:{click:t.signupMode}},[t._v("新用户注册")])],1),t._v(" "),s("span",{staticClass:"footer-separate"},[t._v(" · ")]),t._v(" "),s("span",{staticClass:"footer-text"},[s("el-button",{staticClass:"plain-button",on:{click:t.close}},[t._v("二维码登录")])],1),t._v(" "),s("span",{staticClass:"footer-separate"},[t._v(" · ")]),t._v(" "),s("span",{staticClass:"footer-text"},[s("el-button",{staticClass:"plain-button",on:{click:t.close}},[t._v("社交账号登录")])],1)])]:[s("el-form-item",{staticClass:"flow-nickname",attrs:{prop:"nickname"}},[s("el-input",{staticClass:"nickname",attrs:{placeholder:"姓名"},model:{value:t.form.nickname,callback:function(e){t.$set(t.form,"nickname",e)},expression:"form.nickname"}})],1),t._v(" "),s("el-button",{staticClass:"submit",on:{click:t.accept}},[t._v("注册")]),t._v(" "),s("footer",{staticClass:"login-footer"},[s("div",{staticClass:"left"},[s("span",{staticClass:"footer-text"},[t._v("注册即代表同意")]),t._v(" "),s("span",{staticClass:"footer-text"},[s("el-button",{staticClass:"plain-button",on:{click:t.close}},[t._v("《知书协议》")])],1)]),t._v(" "),s("div",{staticClass:"right"},[s("span",{staticClass:"footer-text"},[t._v("已有账号?")]),t._v(" "),s("span",{staticClass:"footer-text"},[s("el-button",{staticClass:"switch-type",on:{click:t.loginMode}},[t._v("登录")])],1)])])]],2)])],1)])]):t._e()},staticRenderFns:[]};e.a=a},"6/CY":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("tVAR");s.o(a,"default")&&s.d(e,"default",function(){return a.default})},gdbt:function(t,e,s){"use strict";var a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-form",{ref:"captchaForm",staticClass:"login-content accept-content",attrs:{rules:t.rules,model:t.form}},[s("div",{staticClass:"accept-container"},[s("el-button",{staticClass:"plain-button backButton",attrs:{icon:"arrow-left"},on:{click:t.back}}),t._v(" "),s("header",{staticClass:"accept-header"},[s("div",{staticClass:"accept-title"},[t._v(t._s(t.header.title))]),t._v(" "),s("div",{staticClass:"accept-subtitle"},[t._v(t._s(t.header.subtitle))])]),t._v(" "),s("div",{staticClass:"login-flow"},[s("el-form-item",{staticClass:"flow-account accept-account"},[s("el-input",{staticClass:"account",attrs:{value:""+t.form.code+t.form.username,disabled:""}})],1),t._v(" "),s("el-form-item",{staticClass:"flow-nickname",attrs:{prop:"captcha"}},[s("el-input",{staticClass:"nickname",attrs:{placeholder:"请输入 6 位短信验证码"},model:{value:t.form.captcha,callback:function(e){t.$set(t.form,"captcha",e)},expression:"form.captcha"}},[t.awaitCaptcha?s("span",{staticClass:"await-time",attrs:{slot:"append"},slot:"append"},[t._v(t._s(t.awaitCaptcha)+" 秒后可重发")]):s("el-button",{staticClass:"switch-type",attrs:{slot:"append"},on:{click:t.accept},slot:"append"},[t._v("重新获取短信验证码")])],1)],1),t._v(" "),s("div",{staticClass:"login-options"},[s("el-button",{staticClass:"forget-pass",on:{click:t.back}},[t._v("更换登录方式")])],1),t._v(" "),s("footer",{staticClass:"accept-footer-container"},[s("el-button",{staticClass:"submit enter",on:{click:t.signup}},[t._v("进入知书")])],1)],1)],1)])},staticRenderFns:[]};e.a=a},jsiU:function(t,e){},tE8W:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("wWOI"),o=s.n(a);for(var i in a)"default"!==i&&function(t){s.d(e,t,function(){return a[t]})}(i);var n=s("gdbt");var l=function(t){s("jsiU")},r=s("VU/8")(o.a,n.a,!1,l,"data-v-22938048",null);e.default=r.exports},tVAR:function(t,e,s){"use strict";var a=s("uWV8"),o=s.n(a),i=s("1b4C");var n=function(t){s("03le")},l=s("VU/8")(o.a,i.a,!1,n,null,null);e.default=l.exports},uWV8:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=f(s("exGp")),o=f(s("//Fk")),i=f(s("Dd8w")),n=f(s("mvHQ")),l=s("NYxO"),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e.default=t,e}(s("Du/2")),c=s("gyMJ"),u=s("E4LH"),d=f(s("UnHi")),p=f(s("tE8W"));function f(t){return t&&t.__esModule?t:{default:t}}const v=[{code:"+86",name:"中国",abbr:"CN"},{code:"+1",name:"美国",abbr:"US"},{code:"+81",name:"日本",abbr:"JP"},{code:"+886",name:"中国台湾",abbr:"TW"}],m={login:{title:"登录知书",subtitle:"获取来自世界的知识和力量"},signup:{title:"加入知书",subtitle:"与世界探讨知识的绚丽多彩"},accept:{title:"验证手机",subtitle:"请输入你收到的 6 位数验证码"}};e.default={name:"login-card",components:{modalBackdrop:d.default,captchaCard:p.default},data:()=>({visible:!1,mode:"login",header:m,form:{username:"",password:""},syssee:!1,registerable:!0,acceptCaptcha:!1,country:{code:"+86",name:"中国"},countries:v,rules:u.userCheckRules,result:{resolve(){},reject(){}}}),computed:{prefix:{get(){return(0,n.default)(this.country)},set(t){this.country=JSON.parse(t)}},prefixWidth(){let{name:t,code:e}=this.country;return 16*t.length+16*e.length/2+16},fullaccount(){return`${this.country.code}${this.form.username}`},requestForm(){return(0,i.default)({},this.form,{code:this.country.code})}},methods:(0,i.default)({},(0,l.mapMutations)("user",[r.SET_USER]),{open(){return this.visible=!0,new o.default((t,e)=>{this.result={resolve:t,reject:e}})},close(){this.result.reject(),this.visible=!1,this.$nextTick(this.$destroy)},loginMode(){this.mode="login"},signupMode(){this.mode="signup"},backLogin(){this.acceptCaptcha=!1},login(){var t=this;return(0,a.default)(function*(){t.$refs.loginForm.validate(function(t){if(!t)throw new Error("login form not validated")});let e=yield(0,c.login)(t.requestForm);t[r.SET_USER](e),t.result.resolve("logined"),t.close()})()},isRegisted(){var t=this;return(0,a.default)(function*(){try{yield(0,c.isRegisterable)(t.requestForm)}catch(e){throw t.registerable=!1,e}})()},accept(){var t=this;return(0,a.default)(function*(){t.$refs.loginForm.validate(function(t){if(!t)throw new Error("captcha form not validated")}),yield t.isRegisted(),t.acceptCaptcha=!0})()},onSigned(t){this[r.SET_USER](t),this.result.resolve("logined"),this.close()}})}},wWOI:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=l(s("exGp")),o=l(s("Dd8w")),i=s("gyMJ"),n=s("E4LH");function l(t){return t&&t.__esModule?t:{default:t}}e.default={name:"captcha-card",props:{userform:Object,back:Function},data(){return{header:{title:"验证手机",subtitle:"请输入你收到的 6 位数验证码"},form:(0,o.default)({},this.userform),awaitCaptcha:0,rules:n.userCheckRules}},mounted(){this.accept()},methods:{accept(){var t=this;return(0,a.default)(function*(){(0,i.requireSMS)(t.form),t.awaitCaptcha=59;let e=setInterval(function(){t.awaitCaptcha<=0?clearInterval(e):t.awaitCaptcha--},1e3)})()},signup(){var t=this;return(0,a.default)(function*(){t.$refs.captchaForm.validate(function(t){if(!t)throw new Error("signup form not validated")});let e=yield(0,i.signup)(t.form);t.$emit("signed",e)})()}}}}});